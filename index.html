<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ© Ø§Ù„Ø´Ø§Ù…Ù„Ø©</title>
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6847506129570052" crossorigin="anonymous"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #047857; --accent: #b45309; --bg: #f8fafc; }
        body { font-family: 'Cairo', sans-serif; background: var(--bg); margin: 0; padding: 0; color: #1e293b; }
        
        #login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%); z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
        
        header { background: white; padding: 15px 5%; display: none; justify-content: space-between; align-items: center; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 100; }
        
        .user-profile { position: relative; cursor: pointer; display: flex; align-items: center; gap: 10px; }
        #user-img { width: 45px; height: 45px; border-radius: 50%; border: 2px solid var(--primary); }
        
        /* Ù‚Ø§Ø¦Ù…Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ */
        .logout-menu { display: none; position: absolute; top: 55px; left: 0; background: white; border: 1px solid #ddd; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); width: 120px; z-index: 1000; }
        .logout-menu button { width: 100%; padding: 10px; border: none; background: none; font-family: 'Cairo'; cursor: pointer; color: #e11d48; font-weight: bold; border-radius: 10px; }
        .logout-menu button:hover { background: #fff1f2; }

        .container { max-width: 1200px; margin: 30px auto; padding: 20px; display: none; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px; }
        .card { background: white; border-radius: 20px; padding: 25px; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; transition: 0.3s; }
        .card:hover { transform: translateY(-10px); }
        
        .btn { width: 100%; padding: 14px; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; margin-top: 15px; font-family: 'Cairo'; }
        .btn-buy { background: var(--accent); color: white; }
        .btn-read { background: var(--primary); color: white; }
        
        #quiz-section { background: white; padding: 30px; border-radius: 25px; margin-bottom: 40px; text-align: center; border: 2px solid #e2e8f0; }
        .quiz-options { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        .option-btn { padding: 15px; background: #f8fafc; border: 2px solid #e2e8f0; border-radius: 15px; cursor: pointer; font-family: 'Cairo'; }

        .viewer { display: none; background: white; padding: 50px; border-radius: 30px; line-height: 2.4; }
        .viewer h1 { color: var(--primary); }
        .viewer p { font-size: 1.4rem; text-align: justify; white-space: pre-wrap; }
    </style>
</head>
<body>

<div id="login-overlay">
    <div style="background:white; padding:40px; border-radius:30px; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1);">
        <h1 style="color:var(--primary); font-size:2.5rem;">ðŸ“– Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù†Ø®Ø¨Ø©</h1>
        <p style="margin-bottom:30px;">Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ø§Ù„Ø¢Ù† ÙˆØ§Ø³ØªÙ„Ù… 5 Ø¬ÙˆØ§Ù‡Ø± Ù…Ø¬Ø§Ù†ÙŠØ©</p>
        <div id="g_id_onload" 
             data-client_id="295699802302-t4l7rov5vo93g20fuphhbh4sj21dbgu1.apps.googleusercontent.com" 
             data-callback="handleSignIn"
             data-auto_select="true">
        </div>
        <div class="g_id_signin" data-type="standard" data-shape="pill" data-size="large"></div>
    </div>
</div>

<header id="main-header">
    <div style="display:flex; align-items:center;">
        <span id="user-welcome" style="font-weight:bold; color:var(--primary);"></span>
    </div>
    <div style="display:flex; align-items:center; gap:15px;">
        <div style="background:var(--accent); color:white; padding:8px 20px; border-radius:50px; font-weight:900;">ðŸ’Ž <span id="pts">0</span></div>
        
        <div class="user-profile" onclick="toggleLogoutMenu()">
            <img id="user-img" src="">
            <div id="logout-menu" class="logout-menu">
                <button onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
            </div>
        </div>
    </div>
</header>

<div class="container" id="main-content">
    <div id="quiz-section">
        <h2>ðŸ§© ØªØ­Ø¯ÙŠ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©</h2>
        <button class="btn btn-read" style="width:180px;" onclick="showQuiz()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
        <div id="quiz-box" style="display:none; margin-top:20px;">
            <h3 id="q-text"></h3>
            <div class="quiz-options" id="options"></div>
        </div>
    </div>

    <div class="grid" id="stories-grid"></div>

    <div id="story-viewer" class="viewer">
        <button onclick="closeStory()" class="btn" style="width:130px; background:#eee;">â¬… Ø¹ÙˆØ¯Ø©</button>
        <h1 id="v-title"></h1>
        <p id="v-text"></p>
    </div>
</div>

<script>
    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚ØµØµ Ø§Ù„Ø·ÙˆÙŠÙ„Ø©
    const storiesData = [
        { id: 1, title: "ØµØ¨Ø± Ø£ÙŠÙˆØ¨ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù…", price: 150, text: "ÙƒØ§Ù† Ù†Ø¨ÙŠ Ø§Ù„Ù„Ù‡ Ø£ÙŠÙˆØ¨ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù†ÙˆØ§Ù†Ø§Ù‹ Ù„Ù„ØµØ¨Ø± Ø§Ù„Ø¹Ø¸ÙŠÙ…... (Ù‡Ù†Ø§ Ø§Ù„Ù†Øµ Ø§Ù„Ø·ÙˆÙŠÙ„ Ø§Ù„Ø°ÙŠ Ø£Ø¶ÙÙ†Ø§Ù‡ Ø³Ø§Ø¨Ù‚Ø§Ù‹)" },
        { id: 2, title: "Ø£ØµØ­Ø§Ø¨ Ø§Ù„ÙƒÙ‡Ù ÙˆØ§Ù„Ø«Ø¨Ø§Øª", price: 200, text: "ÙÙŠ Ù…Ø¯ÙŠÙ†Ø© ÙŠØ­ÙƒÙ…Ù‡Ø§ Ù…Ù„Ùƒ Ø¬Ø¨Ø§Ø± ÙŠØ³Ù…Ù‰ Ø¯Ù‚ÙŠØ§Ù†ÙˆØ³... (Ù‡Ù†Ø§ Ø§Ù„Ù†Øµ Ø§Ù„Ø·ÙˆÙŠÙ„)" },
        { id: 3, title: "ÙŠÙˆØ³Ù Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù….. Ù…Ù† Ø§Ù„Ø¨Ø¦Ø± Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø´", price: 350, text: "Ø¨Ø¯Ø£Øª Ø£Ø­Ø¯Ø§Ø« Ù‚ØµØ© ÙŠÙˆØ³Ù Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù… Ø¨Ø±Ø¤ÙŠØ§ Ø±Ø¢Ù‡Ø§ ÙˆÙ‡Ùˆ Ø·ÙÙ„... (Ù‡Ù†Ø§ Ø§Ù„Ù†Øµ Ø§Ù„Ø·ÙˆÙŠÙ„)" }
    ];

    // Ø¥Ø¶Ø§ÙØ© Ø¨Ù‚ÙŠØ© Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª (Ù†ÙØ³ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚)
    const titles = ["Ø³Ù„ÙŠÙ…Ø§Ù† ÙˆÙ…Ù†Ø·Ù‚ Ø§Ù„Ø·ÙŠØ±", "ØªÙˆØ¨Ø© Ù‚Ø§ØªÙ„ Ø§Ù„Ù…Ø§Ø¦Ø©", "Ø§Ù„Ø£Ø¹Ù…Ù‰ ÙˆØ§Ù„Ø£Ø¨Ø±Øµ", "Ù…ÙˆØ³Ù‰ ÙˆØ§Ù„Ø¹Ø¨Ø¯ Ø§Ù„ØµØ§Ù„Ø­", "Ø¨Ø·ÙˆÙ„Ø§Øª Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ", "Ø¹Ø¯Ù„ Ø§Ù„ÙØ§Ø±ÙˆÙ‚ Ø¹Ù…Ø±", "Ø³ÙŠØ¯Ø© Ù…ÙƒØ© Ù‡Ø§Ø¬Ø±", "Ø£Ø®Ø¯ÙˆØ¯ Ø§Ù„Ù…Ø¤Ù…Ù†ÙŠÙ†", "ÙŠÙˆÙ†Ø³ ÙˆØ¸Ù„Ù…Ø§Øª Ø§Ù„Ø¨Ø­Ø±"];
    titles.forEach((t, i) => {
        storiesData.push({ id: i + 4, title: t, price: 180 + (i * 10), text: `Ù‡Ø°Ø§ Ù…Ø¬Ù„Ø¯ ÙƒØ§Ù…Ù„ ÙˆÙ…ÙØµÙ„ Ø­ÙˆÙ„ ${t}... ØªÙØ§ØµÙŠÙ„ Ø·ÙˆÙŠÙ„Ø© Ø¬Ø¯Ø§Ù‹ Ø¹Ø¨Ø± ÙˆØ¯Ø±ÙˆØ³ Ù…Ø³ØªÙØ§Ø¯Ø©.` });
    });

    let points = parseInt(localStorage.getItem('user_pts')) || 5;
    let ownedStories = JSON.parse(localStorage.getItem('owned_list')) || [];

    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ù…Ø³Ø¨Ù‚Ø§Ù‹ (Ø®Ø§ØµÙŠØ© ØªØ°ÙƒØ±Ù†ÙŠ)
    window.onload = function() {
        const savedUser = localStorage.getItem('isLoggedIn');
        if (savedUser === 'true') {
            const userData = JSON.parse(localStorage.getItem('userData'));
            showMainPage(userData);
        }
    };

    function handleSignIn(response) {
        const data = JSON.parse(atob(response.credential.split('.')[1]));
        localStorage.setItem('isLoggedIn', 'true');
        localStorage.setItem('userData', JSON.stringify(data));
        showMainPage(data);
    }

    function showMainPage(data) {
        document.getElementById('login-overlay').style.display = 'none';
        document.getElementById('main-header').style.display = 'flex';
        document.getElementById('main-content').style.display = 'block';
        document.getElementById('user-img').src = data.picture;
        document.getElementById('user-welcome').innerText = `Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙƒØŒ ${data.name}`;
        updateUI();
    }

    function toggleLogoutMenu() {
        const menu = document.getElementById('logout-menu');
        menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
    }

    function logout() {
        localStorage.removeItem('isLoggedIn');
        localStorage.removeItem('userData');
        location.reload(); // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ù„Ù„Ø¹ÙˆØ¯Ø© Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
    }

    function updateUI() {
        document.getElementById('pts').innerText = points;
        const grid = document.getElementById('stories-grid');
        grid.innerHTML = '';
        storiesData.forEach(s => {
            const isOwned = ownedStories.includes(s.id);
            grid.innerHTML += `
                <div class="card">
                    <h3>${s.title}</h3>
                    ${isOwned ? `<button class="btn btn-read" onclick="readStory(${s.id})">ðŸ“– Ù‚Ø±Ø§Ø¡Ø©</button>` : `<button class="btn btn-buy" onclick="buyStory(${s.id}, ${s.price})">ðŸ”“ Ø´Ø±Ø§Ø¡ Ø¨Ù€ ${s.price}</button>`}
                </div>`;
        });
        localStorage.setItem('user_pts', points);
        localStorage.setItem('owned_list', JSON.stringify(ownedStories));
    }

    function buyStory(id, price) {
        if (points >= price) {
            points -= price;
            ownedStories.push(id);
            updateUI();
            alert("âœ… ØªÙ… Ø§Ù„ÙØªØ­!");
        } else {
            alert("âŒ Ù†Ù‚Ø§Ø·Ùƒ ØºÙŠØ± ÙƒØ§ÙÙŠØ©!");
        }
    }

    function readStory(id) {
        const s = storiesData.find(x => x.id === id);
        document.getElementById('stories-grid').style.display = 'none';
        document.getElementById('quiz-section').style.display = 'none';
        document.getElementById('story-viewer').style.display = 'block';
        document.getElementById('v-title').innerText = s.title;
        document.getElementById('v-text').innerText = s.text;
    }

    function closeStory() {
        document.getElementById('stories-grid').style.display = 'grid';
        document.getElementById('quiz-section').style.display = 'block';
        document.getElementById('story-viewer').style.display = 'none';
    }

    function showQuiz() {
        const qBox = document.getElementById('quiz-box');
        qBox.style.display = 'block';
        const questions = [
            { q: "Ù…Ù† Ù‡Ùˆ Ø§Ù„Ù†Ø¨ÙŠ Ø§Ù„Ø°ÙŠ Ù„Ù‚Ø¨ Ø¨Ù€ Ø°Ùˆ Ø§Ù„Ù†ÙˆÙ†ØŸ", a: ["ÙŠÙˆÙ†Ø³", "Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…", "Ø¹ÙŠØ³Ù‰"], c: 0 },
            { q: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„Ù‚Ø±Ø¢Ù†ØŸ", a: ["20", "30", "60"], c: 1 }
        ];
        const q = questions[Math.floor(Math.random() * questions.length)];
        document.getElementById('q-text').innerText = q.q;
        const optDiv = document.getElementById('options');
        optDiv.innerHTML = '';
        q.a.forEach((ans, idx) => {
            optDiv.innerHTML += `<button class="option-btn" onclick="checkAnswer(${idx}, ${q.c})">${ans}</button>`;
        });
    }

    function checkAnswer(chosen, correct) {
        if (chosen === correct) {
            const reward = Math.floor(Math.random() * 6) + 5; 
            points += reward;
            alert(`ðŸŽ‰ Ø±Ø¨Ø­Øª ${reward} Ø¬ÙˆØ§Ù‡Ø±!`);
        } else {
            alert("ðŸ˜• Ø®Ø·Ø£!");
        }
        document.getElementById('quiz-box').style.display = 'none';
        updateUI();
    }
</script>
</body>
</html>